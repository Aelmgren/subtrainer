/*! videojs-transcript - v0.0.0 - 2014-09-11
* Copyright (c) 2014 Matthew Walsh; Licensed MIT */
!function(a,b){"use strict";var c,d=function(){var a=function(a){var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.floor(a%60);return d=10>d?"0"+d:d,c=b>0&&10>c?"0"+c:c,b>0?b+":"+c+":"+d:c+":"+d};return{niceTimestamp:a}}(),e=function(){var a,b,c,e=function(a){return function(){b.currentTime(a)}},f=function(a){var b=document.createElement("div"),f=document.createElement("span"),g=document.createElement("span");return b.className=c+"-line",b.setAttribute("data-begin",a.startTime),f.className=c+"-timestamp",f.textContent=d.niceTimestamp(a.startTime),b.addEventListener("click",e(a.startTime)),g.className=c+"-text",g.innerHTML=a.text,b.appendChild(f),b.appendChild(g),b},g=function(b){if(void 0===a)throw new Error("videojs-transcript: Html not initialized!");var d,e,g=document.createDocumentFragment();b.load(),b.on("loaded",function(){var h=b.cues();for(e=0;e<h.length;e++)d=f(h[e],c),g.appendChild(d);a.appendChild(g),a.setAttribute("lang",b.language())})},h=function(d,e,f){a=d,b=e,c=f,a.className=f,a.id=c+"-"+b.id()};return{init:h,setTrack:g}}(),f=function(){var a=function(a){return a.scrollHeight>a.offsetHeight},b=function(a){a.scrollIntoView(!1)};return{isScrollable:a,scrollIntoView:b}}(),g={autoscroll:!0};c=function(a){var c,d,h=b.util.mergeOptions(g,a),i=this,j="transcript",k=document.createElement("div"),l=function(){var a,b,d=[];for(c=i.textTracks(),a=0;a<c.length;a++)b=c[a].kind(),("captions"===b||"subtitles"===b)&&d.push(c[a]);return d},m=function(a){var b;for(b=0;b<a.length;b++)if(a[b].dflt&&a[b].dflt())return a[b];return a[0]},n=function(){var a,b,c,d=document.querySelectorAll("#"+k.id+" > ."+j+"-line"),e=[];for(a=0;a<d.length;a++)b=d[a],c={element:b,begin:b.getAttribute("data-begin")},e.push(c);return e},o=function(){var a,b,c,d=i.currentTime(),e=n();for(c=0;c<e.length;c++)a=e[c],b=c<e.length-1?e[c+1].begin:i.duration()||1/0,d>a.begin&&b>d?(a.element.classList.add("is-active"),h.autoscroll&&f.isScrollable(k)&&f.scrollIntoView(a.element)):a.element.classList.remove("is-active")};if(c=l(),!(c.length>0))throw new Error("videojs-transcript: No tracks found!");d=m(c),e.init(k,i,j),e.setTrack(d),this.on("timeupdate",o);var p=function(){return k};return{getContainer:p}},b.plugin("transcript",c)}(window,window.videojs);